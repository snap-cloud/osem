# Install Snap!Con
Snap!Con runs Ruby 2.7.6 with Rails 5.2. The backend is provided by PostgreSQL. It is recommended to use RVM to manage the gems for this project. Some JavaScript dependencies are used, which need to be installed via NPM or Yarn.

## Setup
The recommended setup steps are as follows:

1. Run `npm install` or `yarn` to install the necessary JavaScript dependencies.
1. Run `bundle config set without production` to ensure only developmental gems are installed.
1. Run `bundle config set path vendor/bundle` to install gems to `vendor/bundle`.
1. Run `bundle install` to install the necessary gems.
1. Configure your environment variables.
    1. Create `config/local_env.yml`.
    1. At a bare minimum, you will likely need to provide credentials with which to access your PostgreSQL database. An example might be as follows:
        ```
        OSEM_DB_USER: esobeck
        OSEM_DB_PASSWORD: password123
        ```
    1. Other features will require more environment variables. See [Environment Variables](#environment-variables) and [INSTALL.md#configuration](INSTALL.md#configuration) for all the environment variables that may be set.
1. Run `rake db:setup` (this command and all following commands may need to prefixed with `bundle exec`) to initialize the database.

## Local Deployment

To run Snap!Con, using [Overmind](https://github.com/DarthSim/overmind) or [Foreman](https://github.com/ddollar/foreman) is recommended. Since a release command is run which automatically performs migrations, it is necessary to flag the `release` command as able to be exited without closing all other processes. The Rails server may be run via the typical `rails server` command, but do note that no jobs will be run.

## Heroku Deployment

When deploying to Heroku, the `heroku/nodejs` buildpack must be run before the `heroku/ruby` buildpack. Since Snap!Con runs on PostgreSQL, the Postgres add-on must also be added to the Heroku deployment.

Finally, it may be necessary to downgrade the Heroku stack to `heroku-18`. Details on how to downgrade can be found [in this Heroku article](https://devcenter.heroku.com/articles/heroku-18-stack#using-heroku-18).

### Example Data
Example data can easily be generated by running `rake data:demo`. Please note that this command can fail if the database is not fresh.

## Environment Variables

In addition to the environment variables detailed under [INSTALL.md#configuration](INSTALL.md#configuration), the following environment variables may be configured.

### `MAILBLUSTER_API_KEY`
A generated API key necessary to utilize the Mailbluster integration.

### `FULL_CALENDAR_LICENSE_KEY=GPL-My-Project-Is-Open-Source`
If utilizing the FullCalendar display module, necessary to disable the license key warning.
